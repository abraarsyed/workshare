<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>ACE in Action</title>
<style type="text/css" media="screen">
    #editor { 
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
	width:50%;
    }
</style>
	</head>
	<body>
                 <div id="editor"></div>

		<script src="src-noconflict/ace.js"></script>	
		<script src="socket.js"></script>
                <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
		<script>
   			var socket = io();
     			var editor = ace.edit("editor");
    			editor.setTheme("ace/theme/ambiance");
    			editor.getSession().setMode("ace/mode/javascript");
			editor.setPrintMarginColumn(false);
    			editor.setFontSize(28);
			editor.setShowInvisibles(true);
			editor.setflag = false;
    			editor.on('change', function() {
    			//console.log(e.data.text);
    			//socket.emit('textdata',e.data.text);
			if (!editor.setflag) {
				socket.emit('editorUpdate', {
					contents:editor.getValue()
				});
			}	 
   			});
    			socket.on('editorUpdate', function(data){
	 		editor.setflag = true;
        		editor.setValue(data.contents);
			editor.clearSelection();
        		console.log(data);
		 	editor.setflag = false;
    			});
		</script>
	</body>
</html>
